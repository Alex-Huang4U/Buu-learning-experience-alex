# Buu Xor

首先将文件丢进查壳器

![](G:\IDA\buu截图\屏幕截图 2023-11-02 185142.png)

一个没有壳的Mac64位程序

丢进64位ida 进入主函数 看了下汇编学习了下最后跑进F5

![](G:\IDA\wp截图\屏幕截图 2023-11-02 185036.png)

也就是从第二个元素开始，所有元素和在它之前的元素异或，然后与globle对比

根据异或运算的定理

若A ^ B = C 则 C ^ B = A , C ^ A = B

所以只需要将所有元素与前面的元素异或一下即可（异或后值不能改变，让下一个元素与上一个元素异或）

先找到这个字符串

![](G:\IDA\wp截图\屏幕截图 2023-11-02 184942.png)

这里学习了一个快捷键 shift E，可以直接将字符串或者数组转成十六或十进制数组，非常省事

将这些字符丢进写好的脚本，如下

```
list = [0x66, 0x0A, 0x6B, 0x0C, 0x77, 0x26, 0x4F, 0x2E, 0x40, 0x11,
  0x78, 0x0D, 0x5A, 0x3B, 0x55, 0x11, 0x70, 0x19, 0x46, 0x1F,
  0x76, 0x22, 0x4D, 0x23, 0x44, 0x0E, 0x67, 0x06, 0x68, 0x0F,
  0x47, 0x32, 0x4F, 0x00]
flag = chr(list[0])
for i in range(1,len(list)) :
    flag += chr(list[i] ^ list[i -1])
print(flag)
```

即可得到结果flag{QianQiuWanDai_YiTongJiangHu}

非常高兴就是写脚本写太久了

